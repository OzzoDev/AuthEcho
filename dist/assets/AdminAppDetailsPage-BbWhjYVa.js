import{u as O,y as x,z as R,m as U,r as n,A as B,q as f,j as e,O as M,B as z,i as h,C as G,E as l,D as L,R as q,K as Y,N as _}from"./index-C22yq_nU.js";import{A as V}from"./AppDetailsCard-BtXBOw09.js";import{u as $}from"./useManageAppStore-B_OVaFTM.js";import{D as F}from"./Divider-CU5cQYJz.js";import"./AppCardData-DFDdSqLI.js";function Z(){const d=O(),{fetchData:y}=x("PUT","UPDATEAPP"),{fetchData:g}=x("POST","GENERATEAPKEY"),{copyToClipboard:A}=R(),{getApp:j,editApp:v}=$(),{appname:u}=U(),[s,D]=n.useState(j(u)),[o,T]=n.useState(s.resources),[a,p]=n.useState({app:s.name,appName:s.name,appDescription:s.description,origin:s.origin,creator:s.creator,admins:s.admins,resources:s.resources,status:s.status}),[r,N]=n.useState(""),[b,m]=n.useState(!1),w=Object.keys(B).map(t=>f(t));n.useEffect(()=>{const t={name:a.appName,origin:a.origin,creator:a.creator||"",admins:a.admins||[],description:a.appDescription,resources:a.resources,status:a.status||"development",users:s.users};v(t),D(t)},[a]),n.useEffect(()=>{const t=setTimeout(()=>{(async()=>{await y(!1,a)})()},1e3);return()=>clearTimeout(t)},[a]),n.useEffect(()=>{const t={...a,resources:o};p(t)},[o]);const c=t=>{const{name:i,value:K}=t.target,I={...a,[i]:K};p(I)},C=t=>{const i={...a,status:t};p(i)},P=async()=>{const t=await g(!1,a);if(t){const i=t.data.appKey;i&&N(i),m(!1)}},S=()=>{m(t=>!t),A(r)},E=()=>{d("/account/administeredapps")},k=()=>{d(`/account/administeredapps/${u}/traffic`)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between p-4",children:[e.jsx(M,{btnText:"Go back",onClick:E,icon:e.jsx(z,{size:24})}),e.jsx(h,{btnText:"See traffic",onClick:k,icon:e.jsx(G,{size:24})})]}),e.jsx(V,{app:s}),e.jsxs("div",{className:"flex flex-col gap-y-[40px] my-[100px] mx-auto w-[90%] md:w-[80%] lg:w-[70%]",children:[e.jsx(l,{labelText:"Name",name:"appName",value:a.appName,placeholder:"My app",maxLength:100,onChange:c,children:e.jsxs("p",{children:["Enter the name of your application.",e.jsx("span",{className:"text-red-400",children:" Maximum 100 characters"}),"."]})}),e.jsx(l,{labelText:"Origin",type:"url",name:"origin",value:a.origin,maxLength:100,onChange:c,children:e.jsxs("p",{children:["Specify the production domain or development URL (e.g., example.com, http://localhost:3001).",e.jsx("span",{className:"text-red-400",children:" Please note that only one application is allowed per origin."})]})}),e.jsx(l,{labelText:"Description",type:"textarea",name:"appDescription",placeholder:"This is my first Authecho app",value:a.appDescription,maxLength:300,isRequired:!1,onChange:c,children:e.jsxs("p",{children:["You may optionally provide a description for your application",e.jsx("span",{className:"text-red-400",children:" of maximum 300 characters"}),". This description may be publicly accessible and serves to clarify the purpose and functionality of your app, thereby assisting users in understanding its features and benefits."]})}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"text-cyan-200",children:"Status"}),e.jsx(L,{initialValue:f(a.status||""),items:w,onSelect:C}),e.jsx("p",{className:"text-gray-400",children:"Update the status of the application to accurately reflect its operational state, such as whether it is currently running in the development or production environment"})]}),e.jsx(q,{resources:o,setResources:T})]}),e.jsx(F,{dividerText:"Advanced settings",color:"darkcyan"}),e.jsxs("div",{className:"flex flex-col items-center gap-y-8 w-full py-[40px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-x-10 gap-y-6",children:[e.jsx(h,{btnText:"Get new API key",onClick:P,icon:e.jsx(Y,{},24)}),r&&e.jsxs("div",{className:"flex flex gap-x-10 items-center w-fit",children:[e.jsx(_,{text:r}),e.jsx("button",{onClick:S,children:b?"Copied":"Copy"})]})]}),e.jsx("p",{className:"w-[90%] max-w-[600px]",children:"If you have lost access to your application’s API key, you can obtain a new one here. Please note that this key is displayed only once for security purposes. It is strongly recommend that you store it in a secure location for future reference."})]})]})}export{Z as default};
