import{r as a,e as B,j as e,L as J,f as K,u as X,g as Z,a as _,h as i,H as ee,M as se}from"./index-BrTf-wJD.js";import{U as te}from"./UpdateDataDropDown-vbDtto9r.js";import{U as d}from"./UpdateDataForm-pr8K4dVU.js";import{D as ae}from"./Divider-4uKQQNG6.js";function oe({heading:w,extended:c=!1,children:x}){const[m,p]=a.useState(c),y=a.useRef(null);a.useEffect(()=>{p(c)},[c]);const t=()=>{m&&p(!1)},r=()=>{p(n=>!n)};return B(y,t),e.jsxs("div",{ref:y,className:"flex flex-col gap-y-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-x-10 p-4 bg-gradient-to-l from-gray-700 to-gray-800",children:[e.jsx("p",{className:"text-lg font-medium",children:w}),e.jsx("button",{onClick:r,children:m?e.jsx(J,{size:24}):e.jsx(K,{size:24})})]}),m&&e.jsx(e.Fragment,{children:x})]})}function le(){const w=X(),{username:c,email:x,updateUsername:m,updateEmail:p,clearAuth:y}=Z(),{requestData:t,error:r,updateRequestData:n,updateError:E}=_(),{callApi:v}=i("GET","SECURITYQUESTIONS"),{callApi:b}=i("GET","ACCOUNTOVERVIEW"),{callApi:j}=i("POST","REQUESTEMAILCODE"),{callApi:C}=i("PUT","UPDATENAME"),{callApi:T}=i("PUT","UPDATEEMAIL"),{callApi:Q}=i("PUT","UPDATEPASSWORD"),{callApi:D}=i("PUT","UPDATESECURITYQUESTIONANSWER"),{callApi:N}=i("PUT","UPDATESECURITYQUESTION"),{callApi:P}=i("DELETE","DELETEACCOUNT"),[q,O]=a.useState(""),[I,L]=a.useState([]),[h,l]=a.useState(""),[R,A]=a.useState(!1),[V,U]=a.useState(!1),[M,g]=a.useState("idle");a.useEffect(()=>{(async()=>{g("loading");const o=await b();o&&o.data.securityQuestion?(O(o.data.securityQuestion),g("success")):g("error")})()},[t.securityQuestion]),a.useEffect(()=>{(async()=>{const o=await v();if(o){const f=o.data.questions;L(f||[])}})()},[]),a.useEffect(()=>{(h||r)&&A(!0)},[h,r]);const S=()=>{A(!1),l(""),E("")},u=s=>{const{name:o,value:f}=s.target;n({[o]:f}),S()},k=s=>{n({securityQuestion:s}),S()},F=async()=>{const s=await C(!0);l("Username"),s&&(t.name&&m(t.name),n({name:""}))},z=async()=>{await j(!0)&&U(!0)},H=async()=>{const s=await T(!0);l("Email"),s&&(t.email&&p(t.email),n({email:"",verificationCode:""}),U(!1))},W=async()=>{const s=await Q(!0);l("Password"),s&&n({password:""})},Y=async()=>{const s=await D(!0);l("Answer to security question"),s&&n({securityQuestionAnswer:""})},G=async()=>{const s=await N(!0);l("Security question"),s&&n({securityQuestion:""})},$=async()=>{var o;((o=t.deleteCommand)==null?void 0:o.toLowerCase())===`delete ${c.toLowerCase()}`?await P(!0)&&(y(),window.scrollTo({top:0,behavior:"smooth"}),w("/signup")):E("Please provide the right delete command"),n({deleteCommand:""})};return M==="loading"?e.jsx(ee,{size:50,color:"white",className:"m-auto"}):e.jsxs("div",{className:"relative flex flex-col items-center w-full pb-[100px]",children:[e.jsx(oe,{heading:"How to mange my account?",children:e.jsx("p",{className:"p-8 leading-[1.5rem]",children:"Within your account settings, you possess complete control over your account. Here, you can update all available properties, including your username, email address, password, security question, and the corresponding answer. By enabling you to modify all properties, the likelihood of becoming locked out of your account is significantly reduced. For instance, should you wish to update your security question, this can be accomplished with just a few clicks, thereby facilitating easier recall of the credentials necessary for accessing your account. Furthermore, you need not feel that your Authecho account is tied to a specific email address, as you can easily change the email associated with your account. This flexibility allows you to manage access controls as desired. Additionally, you have the option to delete your account if you wish; however, this action is not recommended, as it is irreversible."})}),e.jsxs("div",{className:"flex flex-col items-center gap-y-20 mt-[100px] mb-[80px] w-full",children:[e.jsx(d,{label:"Update username",name:"name",value:t.name||"",placeholder:c,onChange:u,onSubmit:F}),V?e.jsx(d,{type:"password",label:"Verify email",name:"verificationCode",value:t.verificationCode||"",btnText:"Verify",onChange:u,onSubmit:H,children:e.jsxs("p",{className:"text-gray-300",children:["Please check the inbox of your new email address, ",t.email,", for a verification code."]})}):e.jsx(d,{type:"email",label:"Update email",name:"email",value:t.email||"",placeholder:x,onChange:u,onSubmit:z}),e.jsx(d,{type:"password",label:"Update password",name:"password",value:t.password||"",onChange:u,onSubmit:W}),e.jsx(d,{type:"password",label:"Update answser to security question",name:"securityQuestionAnswer",value:t.securityQuestionAnswer||"",onChange:u,onSubmit:Y}),e.jsx(te,{label:"Update security question",items:I,initialValue:q,onSelect:k,onSubmit:G})]}),e.jsx(ae,{dividerText:"Danger zone"}),e.jsx("section",{className:"flex flex-col items-center w-full pt-[40px]",children:e.jsx(d,{label:"Delete account",name:"deleteCommand",value:t.deleteCommand||"",placeholder:`delete ${c}`,isDangerous:!0,btnText:"Delete",onChange:u,onSubmit:$,children:e.jsxs("p",{className:"mt-4",children:["Please proceed with caution. If you choose to delete your account, there will be no way to restore it. To delete your account, please type",e.jsxs("span",{className:"text-red-400",children:[" delete ",c]})," and then click the delete button."]})})}),R&&e.jsx(se,{onClose:S,children:r?e.jsx("p",{className:"text-red-500",children:r}):e.jsxs("p",{className:"text-green-500",children:[h," upated successfully",h==="Security question"&&e.jsx("span",{className:"text-green-300",children:"Â  Please remember to update the answer to your security question if you have not already done so."})]})})]})}export{le as default};
