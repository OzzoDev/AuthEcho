import{g as k,a as z,h as o,r as a,j as s,H as F,M as B}from"./index-BrTf-wJD.js";import{U as J}from"./UpdateDataDropDown-vbDtto9r.js";import{U as u}from"./UpdateDataForm-pr8K4dVU.js";function _(){const{username:w,email:E,updateUsername:U,updateEmail:h}=k(),{requestData:t,error:l,updateRequestData:i,updateError:A}=z(),{callApi:x}=o("GET","SECURITYQUESTIONS"),{callApi:g}=o("GET","ACCOUNTOVERVIEW"),{callApi:Q}=o("POST","REQUESTEMAILCODE"),{callApi:T}=o("PUT","UPDATENAME"),{callApi:v}=o("PUT","UPDATEEMAIL"),{callApi:P}=o("PUT","UPDATEPASSWORD"),{callApi:b}=o("PUT","UPDATESECURITYQUESTIONANSWER"),{callApi:C}=o("PUT","UPDATESECURITYQUESTION"),[j,D]=a.useState(""),[N,q]=a.useState([]),[d,r]=a.useState(""),[O,f]=a.useState(!1),[I,S]=a.useState(!1),[R,p]=a.useState("idle");a.useEffect(()=>{(async()=>{p("loading");const n=await g();n&&n.data.securityQuestion?(D(n.data.securityQuestion),p("success")):p("error")})()},[t.securityQuestion]),a.useEffect(()=>{(async()=>{const n=await x();if(n){const y=n.data.questions;q(y||[])}})()},[]),a.useEffect(()=>{(d||l)&&f(!0)},[d,l]);const m=()=>{f(!1),r(""),A("")},c=e=>{const{name:n,value:y}=e.target;i({[n]:y}),m()},M=e=>{i({securityQuestion:e}),m()},V=async()=>{const e=await T(!0);r("Username"),e&&(t.name&&U(t.name),i({name:""}))},L=async()=>{await Q(!0)&&S(!0)},W=async()=>{const e=await v(!0);r("Email"),e&&(t.email&&h(t.email),i({email:"",verificationCode:""}),S(!1))},Y=async()=>{const e=await P(!0);r("Password"),e&&i({password:""})},G=async()=>{const e=await b(!0);r("Answer to security question"),e&&i({securityQuestionAnswer:""})},H=async()=>{const e=await C(!0);r("Security question"),e&&i({securityQuestion:""})};return R==="loading"?s.jsx(F,{size:50,color:"white",className:"m-auto"}):s.jsxs("div",{className:"relative flex flex-col items-center w-full pb-[100px]",children:[s.jsxs("div",{className:"flex flex-col items-center gap-y-20 mt-[100px] mb-[80px] w-full",children:[s.jsx(u,{label:"Update username",name:"name",value:t.name||"",placeholder:w,onChange:c,onSubmit:V}),I?s.jsx(u,{type:"password",label:"Verify email",name:"verificationCode",value:t.verificationCode||"",btnText:"Verify",onChange:c,onSubmit:W,children:s.jsxs("p",{className:"text-gray-300",children:["Please check the inbox of your new email address, ",t.email,", for a verification code."]})}):s.jsx(u,{type:"email",label:"Update email",name:"email",value:t.email||"",placeholder:E,onChange:c,onSubmit:L}),s.jsx(u,{type:"password",label:"Update password",name:"password",value:t.password||"",onChange:c,onSubmit:Y}),s.jsx(u,{type:"password",label:"Update answser to security question",name:"securityQuestionAnswer",value:t.securityQuestionAnswer||"",onChange:c,onSubmit:G}),s.jsx(J,{label:"Update security question",items:N,initialValue:j,onSelect:M,onSubmit:H})]}),O&&s.jsx(B,{onClose:m,children:l?s.jsx("p",{className:"text-red-500",children:l}):s.jsxs("p",{className:"text-green-500",children:[d," upated successfully",d==="Security question"&&s.jsx("span",{className:"text-green-300",children:"Â  Please remember to update the answer to your security question if you have not already done so."})]})})]})}export{_ as default};
